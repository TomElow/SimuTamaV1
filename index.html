import java.util.Random;

public class TamagotchiV1 {

    enum Stage {
        EGG, BABY, CHILD, TEEN, ADULT, DEAD
    }

    private Stage stage = Stage.EGG;
    private int ageMinutes = 0;

    private int hunger = 4;       // 0 (affam√©) -> 4 (plein)
    private int happiness = 4;    // 0 -> 4
    private int discipline = 50;  // 0 -> 100
    private int careMistakes = 0;
    private int poopCount = 0;

    private boolean isSick = false;
    private boolean isSleeping = false;
    private boolean attentionCall = false;

    /* ===== TEMPS ===== */

    public void tick() {
        if (stage == Stage.DEAD) return;

        ageMinutes++;

        // √âvolution
        updateStage();

        // D√©gradation naturelle toutes les 30 minutes
        if (ageMinutes % 30 == 0) {
            hunger = Math.max(0, hunger - 1);
            happiness = Math.max(0, happiness - 1);
            poopCount++;
        }

        // Appel si besoin
        if ((hunger == 0 || happiness == 0) && !attentionCall) {
            attentionCall = true;
        }

        // Care mistake apr√®s 15 minutes d'appel ignor√©
        if (attentionCall && ageMinutes % 15 == 0) {
            careMistakes++;
            discipline = Math.max(0, discipline - 5);
            attentionCall = false;
        }

        // Maladie
        if (poopCount >= 4 || hunger == 0) {
            isSick = true;
        }

        // Mort
        if (careMistakes >= 10 || (isSick && hunger == 0)) {
            stage = Stage.DEAD;
            System.out.println("üíÄ Tamagotchi est mort.");
        }
    }

    /* ===== ACTIONS ===== */

    public void feedMeal() {
        hunger = Math.min(4, hunger + 1);
        poopCount++;
        attentionCall = false;
    }

    public void feedSnack() {
        happiness = Math.min(4, happiness + 1);
        discipline = Math.max(0, discipline - 2);
        attentionCall = false;
    }

    public void playGame() {
        happiness = Math.min(4, happiness + 1);
        attentionCall = false;
    }

    public void cleanPoop() {
        poopCount = 0;
    }

    public void giveMedicine() {
        if (isSick) {
            isSick = false;
        }
    }

    public void discipline() {
        if (attentionCall) {
            discipline = Math.min(100, discipline + 10);
            attentionCall = false;
        }
    }

    public void toggleLight() {
        isSleeping = !isSleeping;
    }

    /* ===== √âVOLUTION ===== */

    private void updateStage() {
        if (stage == Stage.EGG && ageMinutes >= 5) {
            stage = Stage.BABY;
        } else if (stage == Stage.BABY && ageMinutes >= 60) {
            stage = Stage.CHILD;
        } else if (stage == Stage.CHILD && ageMinutes >= 1440) {
            stage = Stage.TEEN;
        } else if (stage == Stage.TEEN && ageMinutes >= 2880) {
            stage = Stage.ADULT;
        }
    }

    /* ===== DEBUG ===== */

    public void status() {
        System.out.println("==== STATUS ====");
        System.out.println("Stage        : " + stage);
        System.out.println("Age (min)    : " + ageMinutes);
        System.out.println("Hunger       : " + hunger);
        System.out.println("Happiness    : " + happiness);
        System.out.println("Discipline   : " + discipline);
        System.out.println("CareMistakes : " + careMistakes);
        System.out.println("Poop         : " + poopCount);
        System.out.println("Sick         : " + isSick);
        System.out.println("================");
    }

    /* ===== MAIN ===== */

    public static void main(String[] args) throws InterruptedException {
        TamagotchiV1 tama = new TamagotchiV1();

        while (tama.stage != Stage.DEAD) {
            tama.tick();
            tama.status();

            // Simulation automatique
            if (tama.hunger < 2) tama.feedMeal();
            if (tama.happiness < 2) tama.playGame();
            if (tama.poopCount >= 2) tama.cleanPoop();
            if (tama.isSick) tama.giveMedicine();

            Thread.sleep(200); // 1 tick = 1 minute simul√©e
        }
    }
}
